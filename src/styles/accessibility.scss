@use 'variables' as *;

// ===== SKIP NAVIGATION =====
// (Potential future use)
.skip-link {
    position: absolute;
    top: -40px;
    left: $spacing-sm;
    z-index: $z-tooltip;
    padding: $spacing-sm $spacing-md;
    color: $color-background;
    font-weight: 600;
    text-decoration: none;
    background: $color-primary;
    border-radius: $radius-sm;
    transition: top $duration-fast ease;

    &:focus {
        top: $spacing-sm;
    }
}

// ===== FOCUS MANAGEMENT =====
*:focus {
    outline: 2px solid $color-primary;
    outline-offset: 2px;
}

// ===== SELECTION STYLING =====
::selection {
    color: $color-background;
    background-color: $color-primary;
}

// ===== FORM ACCESSIBILITY =====
input,
textarea,
select {
    color: $color-text;
    background-color: $color-surface-elevated;
    border-color: $color-border;

    &::placeholder {
        color: $color-text-muted;
    }

    &:focus {
        border-color: $color-primary;
        outline: 2px solid transparent;
        outline-offset: 2px;
        box-shadow: 0 0 0 2px rgb(245 158 11 / 30%);
    }

    &:invalid {
        border-color: $color-error;
        box-shadow: 0 0 0 2px rgb(239 68 68 / 20%);
    }

    &:valid {
        border-color: $color-success;
        box-shadow: 0 0 0 2px rgb(34 197 94 / 20%);
    }
}

// ===== KEYBOARD NAVIGATION =====
button:focus-visible,
[role='button']:focus-visible,
a:focus-visible {
    outline: 2px solid $color-primary;
    outline-offset: 2px;
    box-shadow: 0 0 0 4px rgb(245 158 11 / 30%);
}

[tabindex='0']:focus,
[tabindex='-1']:focus {
    outline: 2px solid $color-primary;
    outline-offset: 2px;
}

// ===== SCREEN READER UTILITIES =====
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    margin: -1px;
    padding: 0;
    overflow: hidden;
    white-space: nowrap;
    border: 0;
    clip-path: inset(50%);
}

// Currently unused
.sr-only-focusable:focus {
    position: static;
    width: auto;
    height: auto;
    margin: 0;
    padding: inherit;
    overflow: visible;
    white-space: normal;
    clip-path: none;
}

// ===== USER PREFERENCE ADAPTATIONS =====
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        transition-duration: 0.01ms !important;
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        scroll-behavior: auto !important;
    }

    button:hover,
    [role='button']:hover,
    a:hover {
        transition:
            background-color $duration-fast ease,
            border-color $duration-fast ease,
            color $duration-fast ease;
    }
}

@media (prefers-contrast: more) {
    * {
        transition-duration: 0.01ms !important;
    }

    button,
    input,
    textarea,
    select,
    .card,
    [role='button'] {
        border-style: solid !important;
        border-width: 2px !important;
    }

    *:focus {
        outline-width: 3px !important;
        outline-offset: 3px !important;
    }

    .backdrop-blur,
    [style*='backdrop-filter'] {
        backdrop-filter: none !important;
    }

    // Ensure text contrast
    .text-muted,
    .text-secondary {
        color: $color-text !important;
    }
}

@media (prefers-color-scheme: dark) {
    img {
        filter: brightness(0.95);
    }
}

// ===== ARIA LIVE REGIONS =====
[aria-live='polite'],
[aria-live='assertive'] {
    position: absolute;
    left: -10000px;
    width: 1px;
    height: 1px;
    overflow: hidden;
}

// ===== ERROR STATES =====
[aria-invalid='true'] {
    border-color: $color-error !important;
    box-shadow: 0 0 0 2px rgb(239 68 68 / 30%) !important;
}

[aria-describedby] {
    position: relative;
}

.error-message {
    margin-top: $spacing-xs;
    color: $color-error;
    font-size: $font-size-sm;
}

.success-message {
    margin-top: $spacing-xs;
    color: $color-success;
    font-size: $font-size-sm;
}

// ===== LOADING STATES =====
[aria-busy='true'] {
    opacity: 0.7;
    pointer-events: none;
}

// ===== RESPONSIVE TEXT =====
@media (width <= 767px) {
    button,
    [role='button'],
    a,
    input,
    textarea,
    select {
        min-width: 44px;
        min-height: 44px;
    }
}

// ===== PRINT ACCESSIBILITY =====
@media print {
    a[href]::after {
        content: ' (' attr(href) ')';
        font-size: smaller;
    }

    [aria-hidden='true'],
    .decorative {
        display: none !important;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        color: black !important;
        background: none !important;
    }
}
